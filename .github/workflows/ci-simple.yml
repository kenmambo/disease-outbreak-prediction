name: ğŸ¦  Disease Outbreak CI (Simplified)

on:
  push:
    branches: [ main ]
  pull_request:
    branches: [ main ]

env:
  PYTHON_VERSION: "3.10"

jobs:
  # ğŸ§ª Basic testing
  test:
    name: ğŸ§ª Basic Tests
    runs-on: ubuntu-latest
    
    steps:
    - name: ğŸ“¥ Checkout repository
      uses: actions/checkout@v4
      
    - name: ğŸ Set up Python
      uses: actions/setup-python@v4
      with:
        python-version: ${{ env.PYTHON_VERSION }}
        
    - name: âš¡ Install uv
      run: |
        curl -LsSf https://astral.sh/uv/install.sh | sh
        echo "$HOME/.cargo/bin" >> $GITHUB_PATH
        
    - name: ğŸ“¦ Install dependencies
      run: |
        uv venv
        source .venv/bin/activate
        uv pip install -e .
        
    - name: ğŸ§ª Run basic tests
      run: |
        source .venv/bin/activate
        python -c "import sys; print(f'Python {sys.version}')"
        python -c "import disease_outbreak_prediction; print('âœ… Package import successful')"
        
    - name: ğŸ“Š Test data loading
      run: |
        source .venv/bin/activate
        python -c "
        from disease_outbreak_prediction.data_acquisition import fetch_disease_data
        data = fetch_disease_data()
        print(f'âœ… Data loaded: {len(data)} rows')
        "

  # ğŸ” Code quality
  lint:
    name: ğŸ” Code Quality
    runs-on: ubuntu-latest
    
    steps:
    - name: ğŸ“¥ Checkout repository
      uses: actions/checkout@v4
      
    - name: ğŸ Set up Python
      uses: actions/setup-python@v4
      with:
        python-version: ${{ env.PYTHON_VERSION }}
        
    - name: âš¡ Install uv
      uses: astral-sh/setup-uv@v2
      with:
        enable-cache: true

    - name: ğŸ“¦ Install dependencies
      run: |
        uv venv
        source .venv/bin/activate
        uv pip install -e ".[dev]"

    - name: ğŸ” Run basic linting
      run: |
        source .venv/bin/activate
        echo "Running flake8..."
        uv run flake8 src/ --count --select=E9,F63,F7,F82 --show-source --statistics || true
        echo "Checking import sorting..."
        uv run isort --check-only src/ || true
        echo "Checking code formatting..."
        uv run black --check src/ || true